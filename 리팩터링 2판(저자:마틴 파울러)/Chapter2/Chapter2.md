# Chapter2. 리팩터링 원칙

## 2.1 리팩터링 정의

- 리팩터링[명사]: 소프트웨어의 겉보기 동작은 그대로 유지한 채,코드를 이해하고 수정하기 쉽도록 내부 구조를 변경하는 방법
- 리팩터링[동사]: 소프트웨어의 겉보기 동작은 그대로 유지한채, 여러가지 리팩터링 기업을 적용해서 소프트웨어를 재구성하다

  - 지금껏 수많은 사람이 코드를 정리하는 작업을 모조리 '리팩토링'이라고 표현하고 있는데, 앞에서 제시한 정의를 따르면 특정한 방식에 따랄 코드를 정리하는 것만이 리팩터링이다
  - 한번에 나눌 수 있는 작업을 수많은 단계로 잘게 나눠서 작업하면 리팩터링 하는것이 비효율적이라고 생각하기 쉽다. 그러나 단계들이 체계적으로 구성되어있기 때문에 디버깅하는 시간을 줄여줘서 오히려 작업이 더 빨라진다
  - 리패터링의 목적은 코드를 이해하고 수정하기 쉽게 만드는 것이다
  - 리팩터링 전과 후의 코드가 똑같이 작동해야한다. 심지어 리팩터링 과정에서 발견된 버그는 리팩터릴ㅇ 후에도 그대로 남아있어야 한다

## 2.2 두 개의 모자

- **소프트웨어를 개발할 때 목적이 '기능 추가'냐, 아니면 '리팩터링'이냐를 명확히 구분해 작업한다**
  - 기능을 추가할 때는 기존 코드는 절대 건드릴지 않고 새 기능을 추가하기만 한다
  - 리팩터링할 때는 기능추가는 절대 하지 않기로 다짐한 뒤 오롤지 코드 재구성에만 전념한다

## 2.3 리팩터링하는 이유

- **리팩터링하면 소프트웨어 설계가 좋아진다**

  - 아키텍처를 충분히 이해하지 못한 채 단기 목표만을 위해 코드를 수정하다 보면 기반 구조가 무너지기 쉽다
  - 코드만으로 설계르 파악하기 어려워질수록 설계를 유지하기 어려워지고, 설계가 부패되는 속도는 더욱 빨라진다
  - 중복 코드 제거는 설계 개선 작업의 중요한 축을 차지한다
  - 코드가 길수록 실수 없이 수정하기 어려워진다. 이해해야 할 코드량도 늘어난다
  - 중복코드를 제거하면 모든 코드가 언제나 고유한 일을 수행함을 보장할 수 있다
  - <U>규칙적인 리팩터링은 코드의 구조를 지탱해줄 것이다</U>

- **리팩터링하면 소프트웨어를 이해하기 쉬워진다**

  - 다른 프로그래머가 내 코드를 제대로 이해했다면 한 시간에 끝낼 수정을 일주일이나 걸린다면 문제가 된다. 그리고 때때로 이 프로그래머는 나 자신이 되는 순간이 많다
  - 프로그램을 동작시키는 데만 신경 쓰다 보면 나중에 그 코드르 다룰 개발자를 배려하지 못한다
  - <U>리팩터링은 코드가 더 잘 읽히게 도와주고 코드의 목적이 잘 드러나게, 다시 말해 내 의도르 더 명확하게 전다하도록 개선할 수 있다</U>

- **리팩터링하면 버그를 쉽게 찾을 수 있다**

  - 리팩터링하면 코드가 하는 일을 깊이 파악하게 되면서 새로 깨달은 것을 곧바로 코드에 반영하게 된다
  - 리팩터링은 코드의 구조를 명확하게 다듬어주고 견고한 코드 작성하는데 무척 효과적이다

- **리팩터링하면 프로그래밍 속도르 높일 수 있다**
  - 한 시스템을 왜 개바하게되면 코드베이스에 패치에 패치가 더해져서 나중에는 프로그램의 동작을 이해하기도 힘들고 버그파악,새로운 기능추가가 어려워 진다
  - 초기 개발속도는 빠르나 장기적으로 봤을 때 개발속도가 느리다
  - 내부 품질이 뛰어난 코드베이스는 새 기능 구축을 돕는 견고한 토대가 된다
  - <U>설계 지구력 가설: 내부 설계에 심혈을 기울이면 소프트웨어의 지구력이 높아져서 빠르게 개발할 수 있는 상태를 더 오래 지속할 수 있다</U>

## 2.4 언제 리팩터링해야 할까?

- **3의 법칙**

1. 처음에는 그냥 한다
2. 비슷한 일을 두 번째로 하게되면(중복이 생겼다는 사실에 당황스럽겠지만), 일단 계속 진행한다
3. 비슷한 일을 세 번째 하게 되면 리팩터링한다

- **준비를 위한 리팩터링: 기능을 쉽게 추가하게 만들기**

  - <U>리팩터링하기 가장 좋은 시점은 코드베이스에 기능을 새로 추가하기 직전이다</U>
  - 이 시점에 현재 코드를 살펴보면서, 구조를 살짝 바꾸면 다른 작업을 하기가 훨씬 쉬워질 만한 부분을 찾는다
  - 기능을 추가할 때 복제하는 경우가 많은데 만약 원복 코드에 버그가 있다면 나중에 복제한 코드들을 전부 수정해야한다
  - 리팩터링으로 상황을 개선해놓으면 버그가 수정된 상태가 오래 지속될 가능성을 높이는 동시에, 같은 곳에서 다를ㄴ 버그가 발생활 가능성을 줄일 수도 있다

- **이해를 위한 리팩터링: 코드를 이해하기 쉽게 만들기**
